<!DOCTYPE html>
<!-- Coding By CodingNepal - youtube.com/codingnepal -->
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Price Range Slider | CodingNepal</title>
    <style>
      .slider {
        height: 60px;
        width: 100%;
        position: relative;
      }
      .slider .range-selected {
        height: 100%;
        left: 0%;
        right: 0%;
        position: absolute;
        background: #8888;
      }
      .slider .range-selected-center {
        height: 100%;
        left: 0%;
        right: 0%;
        position: absolute;
        background: #fff0;
        cursor: move;
      }
      .range-input {
        position: absolute;
        height: 100%;
        width: 100%;
      }
      .range-input input {
        position: absolute;
        width: 100%;
        height: 100%;
        background: none;
        pointer-events: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        cursor: col-resize;
      }
      input[type="range"]::-webkit-slider-thumb {
        height: 100%;
        width: 2px;
        pointer-events: auto;
        -webkit-appearance: none;
      }
      input[type="range"]::-moz-range-thumb {
        height: 100%;
        width: 2px;
        pointer-events: auto;
        -moz-appearance: none;
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <div>
      <div class="slider" id="slider">
        <div class="range-input">
          <div class="range-selected" id="range-left-selected"></div>
          <div class="range-selected-center" id="range-center-selected"></div>
          <div class="range-selected" id="range-right-selected"></div>
          <input type="range" id="range-left" />
          <input type="range" id="range-right" />
        </div>
      </div>
    </div>
    <script>
      const left = document.getElementById("range-left");
      const right = document.getElementById("range-right");
      const selectedLeft = document.getElementById("range-left-selected");
      const selectedCenter = document.getElementById("range-center-selected");
      const selectedRight = document.getElementById("range-right-selected");
      const slider = document.getElementById("slider");
      var rangeValues = {
        left: -500,
        right: 500,
        min: -1000,
        max: 1000,
        step: 1,
        gap: 100,
      };

      function setValue(range) {
        left.step = range.step;
        left.min = range.min;
        left.max = range.max;
        left.value = range.left;

        right.step = range.step;
        right.min = range.min;
        right.max = range.max;
        right.value = range.right;
      }

      setValue(rangeValues);
      updateSlider();

      function updateSlider() {
        let start_bar = ((rangeValues.left - rangeValues.min) / (rangeValues.max - rangeValues.min)) * 100;
        let end_bar = ((rangeValues.right - rangeValues.min) / (rangeValues.max - rangeValues.min)) * 100;
        console.log(start_bar, end_bar, rangeValues.left, rangeValues.right);

        selectedLeft.style.right = 100 - start_bar + "%";
        selectedRight.style.left = end_bar + "%";
        selectedCenter.style.left = start_bar + "%";
        selectedCenter.style.right = 100 - end_bar + "%";
      }

      selectedCenter.addEventListener("mousedown", (event) => {
        console.log("mousedown", event, slider);
      });

      selectedCenter.addEventListener("mousemove", (event) => {
        console.log("mousemove", event, slider);
      });

      left.addEventListener("input", (e) => {
        rangeValues.left = e.target.valueAsNumber;
        if (rangeValues.right - rangeValues.left < rangeValues.gap) {
          if (rangeValues.right < rangeValues.max) {
            rangeValues.right = rangeValues.left + rangeValues.gap;
          }
          if (rangeValues.right >= rangeValues.max) {
            rangeValues.right = rangeValues.max;
            rangeValues.left = rangeValues.right - rangeValues.gap;
            left.value = rangeValues.left;
          }
          right.value = rangeValues.right;
        }
        updateSlider();
      });

      right.addEventListener("input", (e) => {
        rangeValues.right = e.target.valueAsNumber;
        if (rangeValues.right - rangeValues.left < rangeValues.gap) {
          if (rangeValues.left > rangeValues.min) {
            rangeValues.left = rangeValues.right - rangeValues.gap;
          }
          if (rangeValues.left <= rangeValues.min) {
            rangeValues.left = rangeValues.min;
            rangeValues.right = rangeValues.left + rangeValues.gap;
            right.value = rangeValues.right;
          }
          left.value = rangeValues.left;
        }
        updateSlider();
      });
    </script>
  </body>
</html>
